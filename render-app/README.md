# BNAL Bank - Финансовая Платформа

Многовалютная финансовая платформа с поддержкой криптовалют и интеграцией с Telegram.

## Деплой на Render.com

### Предварительные требования

1. **Аккаунт на Render.com**
2. **GitHub репозиторий** с кодом проекта
3. **Telegram Bot Token** - получите у [@BotFather](https://t.me/BotFather)
4. **Опционально:** API ключ CoinGecko Pro для стабильного получения курсов валют

### Шаги для деплоя

1. **Загрузка кода на GitHub**
   - Загрузите содержимое директории `render-app` в ваш репозиторий на GitHub

2. **Настройка сервиса на Render.com**
   - Откройте [dashboard.render.com](https://dashboard.render.com/)
   - Выберите "New Web Service" и подключите ваш GitHub репозиторий
   - **Важно:** Если репозиторий содержит только директорию `render-app`, оставьте Root Directory пустым

3. **Настройка параметров**
   - **Name:** bnal-bank (или любое другое имя)
   - **Environment:** Node
   - **Build Command:** `chmod +x build.sh && ./build.sh`
   - **Start Command:** `chmod +x start.sh && ./start.sh`
   - **Plan:** Starter ($7/мес) или бесплатный

4. **Добавление переменных окружения**
   - `NODE_ENV` = `production`
   - `RENDER` = `true`
   - `TELEGRAM_BOT_TOKEN` = ваш токен бота
   - `COINGECKO_API_KEY` = ваш API ключ (опционально)
   - `SESSION_SECRET` - будет сгенерирован автоматически

5. **Добавление постоянного хранилища**
   - **Create Disk** с именем `data`
   - Объем: 1 ГБ
   - Путь монтирования: `/data`

6. **Запуск деплоя**
   - Нажмите "Create Web Service"
   - Дождитесь завершения деплоя (5-10 минут)

### Решение проблем

Если вы получаете ошибку "Корневой каталог службы отсутствует", проверьте:

1. **Root Directory:**
   - Оставьте поле пустым или укажите `.` (точку)
   - Если проект находится в директории, укажите путь к ней
   
2. **Структура репозитория:**
   - Убедитесь, что файлы `build.sh` и `start.sh` находятся в корневой директории

3. **render.yaml:**
   - Проверьте, что параметр `rootDir` имеет корректное значение (`.`)

Дополнительная информация в файле `troubleshooting.md`

## Переменные окружения

### Обязательные

- `NODE_ENV` - режим работы приложения (`development` или `production`)
- `RENDER` - признак работы на платформе Render.com (`true` или `false`)
- `TELEGRAM_BOT_TOKEN` - токен для Telegram бота
- `SESSION_SECRET` - секрет для шифрования сессий

### Опциональные

- `COINGECKO_API_KEY` - ключ API CoinGecko Pro (для стабильного получения курсов)
- `WEBAPP_URL` - URL приложения (устанавливается автоматически)
- `RENDER_EXTERNAL_URL` - URL сервиса на Render.com (устанавливается автоматически)

## Тестирование

После успешного деплоя:

1. Откройте URL вашего приложения
2. Войдите с учетной записью:
   - Логин: `admin`
   - Пароль: `admin123`
3. Проверьте работу основных функций:
   - Просмотр карт и баланса
   - Переводы между картами
   - Просмотр транзакций
   - Обмен валют

## Telegram бот

Телеграм бот автоматически настраивается при деплое на Render.com:

1. В production режиме устанавливается webhook для мгновенной обработки сообщений
2. В development режиме используется long polling

Чтобы открыть приложение через бота:
1. Найдите вашего бота по имени в Telegram
2. Отправьте команду `/start`
3. Нажмите кнопку "Открыть приложение"